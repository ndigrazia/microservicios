- [Prácticas y Lineamientos](#prácticas-y-lineamientos)
  - [Objetivo](#objetivo)
  - [Colas asincrónicas](#colas-asincrónicas)
    - [Actualizaciones asincrónicas mediante mensajes de comandos](#actualizaciones-asincrónicas-mediante-mensajes-de-comandos)
    - [Procesamiento idempotente](#procesamiento-idempotente)
    - [Eliminación de mensajes basura encolados](#eliminación-de-mensajes-basura-encolados)
    - [Definición de timeouts y de reintentos demorados](#definición-de-timeouts-y-de-reintentos-demorados)
    - [Definición de tamaño de la cola de mensajería](#definición-de-tamaño-de-la-cola-de-mensajería)
    - [Creación de un procesador de mensajes basura encolados](#creación-de-un-procesador-de-mensajes-basura-encolados)
    - [Monitorización del procesamiento de mensajes asincrónicos](#monitorización-del-procesamiento-de-mensajes-asincrónicos)
  - [Micro Servicios](#micro-servicios)
    - [Reporte de estado de salud](#reporte-de-estado-de-salud)
    - [Configuración elástica](#configuración-elástica)
    - [Reporte de métricas o telemetrías](#reporte-de-métricas-o-telemetrías)
    - [Trazabilidad distribuida](#trazabilidad-distribuida)
    - [Registro de eventos](#registro-de-eventos)
    - [Mecanismo de comunicación](#mecanismo-de-comunicación)
    - [Tolerancia a fallas](#tolerancia-a-fallas)
    - [Altamente cohesivos](#altamente-cohesivos)
    - [Mínimamente acoplados](#mínimamente-acoplados)
    - [Empaquetado como imagen de contenedor](#empaquetado-como-imagen-de-contenedor)
    - [Plataforma centrada en contenedores](#plataforma-centrada-en-contenedores)
    - [Despliegue mediante pipeline](#despliegue-mediante-pipeline)
    - [Único repositorio](#único-repositorio)
    - [Adecuado nivel de complejidad para el dominio problema](#adecuado-nivel-de-complejidad-para-el-dominio-problema)
    - [Identificador semántico de la imagen en el repositorio de código fuente](#identificador-semántico-de-la-imagen-en-el-repositorio-de-código-fuente)

# Prácticas y Lineamientos

## Objetivo

El objetivo del presente documento es que los usuarios/desarrolladores conozcan las prácticas y los lineamientos a ser tenidos en cuenta durante el desarrollo.

Cada lineamiento se estructura de la siguiente manera: 

 - Declaración: Decisión de arquitectura que el equipo de desarrollo DEBE implementar.
 - Racional: Motivo por el cual se establece la declaración.
 - Implicaciones: Acciones para llevar a cabo la declaración.
 

## Colas asincrónicas 

### Actualizaciones asincrónicas mediante mensajes de comandos

|               |                                                                                                                                                                                                                                                                                                                                                    |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Favorecer el envío de mensajes de comandos asincrónicos para actualizar datos. |
| Racional      | Las aplicaciones que realizan actualizaciones sincrónicas suelen responder con invocaciones a la capa de servicio. En este enfoque todas las llamadas del servicio deben completarse antes de retornar una respuesta. Este modelo también requiere que la escalabilidad y la disponibilidad de la capa de servicio coincidan e incluso, superen a los requerimientos de la capa de presentación, que en algunos casos puede ser difícil de determinar como por ejemplo, cuando se usan servicios de terceros para resolver los pedidos. También, puede ocurrir que un servicio no sea confiable o que su procesamiento sea lento, llevando a arruinar la experiencia del usuario y a afectar negativamente la escalabilidad. El uso de colas y los mensajes que indiquen la actividad a realizar, permiten desacoplar el cliente del servicio encargado de resolver la solicitud. Esta separación lleva a que el cliente no tenga que esperar por una respuesta, garantizando tiempos de retorno (responsiveness) consistentemente rápidos.              |
| Implicaciones |- Acordar la estructura del mensaje de comando que es enviado del emisor al receptor.<br> - Acordar la instancia de cola de mensajes a utilizar.<br> - Construir componente encargado de actualizar el dato en la base de datos (data pump).
 |

### Procesamiento idempotente

|               |                                                                                                                                                                                                                                                                                                                                                    |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Posibilitar el procesamiento idempotente de los mensajes asincrónicos. |
| Racional      | Los mensajes almacenados en una cola de mensajería son removidos para su posterior tratamiento. Cuando un mensaje se remueve de la cola no se elimina definitivamente (client acknowledge mode), sino que es ocultado durante un periodo de tiempo haciendo que el mensaje no esté disponible para ser procesado simultáneamente por otro servicio. Puede ocurrir, por algún motivo, que un mensaje no sea procesado totalmente, haciendo que el mismo quede disponible en la cola para continuar con su procesamiento. Cualquier mensaje que es procesado por segunda vez puede traer inconvenientes, ya que muchas de las actividades realizadas en su procesamiento no requieren ser ejecutadas nuevamente. Para resolver este problema se necesita un procesamiento idempotente. El procesamiento idempotente me garantiza que el mensaje puede procesarse varias veces y aun así conseguir el mismo resultado que se obtendría si se realizase una sola vez.             |
| Implicaciones |- Definir una variable de conteo que permite conocer la cantidad de veces que un mensaje es tratado en la cola de mensajería (muchos servicios de mensajería disponen de una variable para esta función).<br> - Desarrollar lógica adicional para apoyar la idempotencia para mensajes con intentos repetidos de procesamiento.<br>
 |

### Eliminación de mensajes basura encolados

|               |                                                                                                                                                                                                                                                                                                                                                    |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Propiciar la detección y la eliminación de mensajes basura dentro de la cola de mensajes asincrónicos. |
| Racional      | Algunos mensajes no se pueden procesar correctamente debido al contenido del propio mensaje, haciendo que el mensaje retorne a la cola para otro intento de procesamiento (client acknowledge mode). Estos mensajes basuras, que permanecen en la cola, provocan reiterados procesamientos que afectan al rendimiento de la solución.
| Implicaciones |- Se puede usar una variable de conteo que permite conocer la cantidad de veces que se intentó procesar al mensaje.<br> - Almacenar el mensaje basura detectado en otro medio (dead-letter) para luego, poder ser tratado, ya sea manual o automáticamente.<br> - Establecer, de acuerdo a las definiciones del negocio, como realizar el tratamiento de los mensajes basuras.<br>
|

### Definición de timeouts y de reintentos demorados

|               |                                                                                                                                                                                                                                                                                                                                                    |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Aplicar timeouts y reintentos demorados en el envío de mensajes asincrónicos. |
| Racional      | El timeout es un mecanismo que permite dejar de esperar una respuesta brindando aislamiento de fallas, haciendo que el problema en otro servicio no se convierta en nuestro problema. Generalmente, los timeouts se encuentran acompañados de reintentos. Sin embargo, volver a intentar inmediatamente una operación después de una falla tiene pocas consecuencias beneficiosas. Si la operación es parte de un flujo de trabajo crítico donde cancelar o reiniciar el proceso es costoso, es apropiado esperar más tiempo entre intentos, ya que probablemente vuelva a fallar si se vuelve a intentar de inmediato e incluso algunos tipos de fallas pueden potenciarse.             |
| Implicaciones |- Aplicar tiempos de espera en envío de mensajes asincrónicos. <br> - Determinar la estrategia en los reintentos: Incremental, Exponencial o Aleatorización.
|

### Definición de tamaño de la cola de mensajería

|               |                                                                                                                                                                                                                                                                                                                                                    |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Indicar la longitud máxima de una cola de mensajería. |
| Racional      | Controlar el tamaño de las colas, evitando que crezcan indefinidamente, ayuda a mejorar el rendimiento del sistema de mensajería (broker), evita que un crecimiento de los mensajes terminen en un agotamiento de los recursos de memoria, impide el incremento en el tiempo de procesamiento de los mensajes y previene que las transacciones para resolver la solicitud queden bloqueadas esperando la disponibilidad del recurso del sistema de mensajería.             |
| Implicaciones |- Limitar la longitud máxima de una cola a un número determinado de mensajes o a un número determinado de bytes.<br> - Establecer el comportamiento a realizar cuando la cola alcance su tamaño máximo: Descartar mensajes o enviar los mensajes a una cola dead-letter.
|

### Creación de un procesador de mensajes basura encolados

|               |                                                                                                                                                                                                                                                                                                                                                    |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Procesar mensajes basura encolados . |
| Racional      | Durante el procesamiento del mensaje pueden surgir errores que conducen al consumidor a no poder tratar dicho mensaje, ya que carece de la posibilidad de hacerlo. Esta situación resulta en un mensaje basura que, para poder resolver, el consumidor debe enviarlo a otra cola (Eliminación de mensajes basura encolados). La cola de mensajes, comúnmente llamada dead-letter, contiene los mensajes no tratados, los cuales deben ser procesados, ya que de lo contrario se acumularan hasta alcanzar el límite máximo de la cola (Definir el tamaño de la cola de mensajería). Un procesador de mensajes basura asociado a la cola dead-letter debe reparar o almacenar los mensajes. En el caso que el procesador, mediante programación sin intervención humana, pueda reparar el mensaje original, lo envía de vuelta a su cola de origen. Finamente, cuando el mensaje no puede ser reparado, se le informa al humano para que se haga cargo del caso, reparándolo manualmente y reenviándolo a la cola original.             |
| Implicaciones |- Desarrollar lógica adicional para un procesador de mensajes basura que intente averiguar porque no se pueden procesar los mensajes. Para ello debe analizar si el error es estático y determinista o, mediante el uso de algoritmos de machine learning, examinar la anomalía en los datos.<br>- Definir la lógica para reparar el mensaje.<br>- Establecer, de acuerdo a las definiciones del negocio, como tratar aquellos mensajes que no fueron reparados.
|

### Monitorización del procesamiento de mensajes asincrónicos

|               |                                                                                                                                                                                                                                                                                                                                                    |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Monitorizar el procesamiento de mensajes asincrónicos y actuar en consecuencia. |
| Racional      | Observar la utilización de la cola es fundamental para comprender la carga de trabajo y el estado del sistema. Las métricas como la cantidad de mensajes pendientes, la cantidad de consumidores y la tasa de consumo permiten que el sistema pueda diagnosticarse y repararse, ajustando la cantidad de consumidores o estrangulando al productor.             |
| Implicaciones |- Establecer la lógica o la estrategia de monitoreo del consumo de los mensajes en la cola de mensajería.<br>- Definir la lógica para reaccionar y adecuar el procesamiento de los mensajes a las necesidades del negocio. Si durante el análisis se determina que el rendimiento de los consumidores no es suficiente, incrementar el número de los mismos o viceversa. En el caso de no ser posible el uso de más consumidores (debido al costo que esto supone), ralentizar los productores via una señal hasta que el consumidor pueda ponerse al día (back pressure).
|

## Micro Servicios 


### Reporte de estado de salud
|               |                                                                                                                                                                                                                                                                                                                                                    |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Reportar el estado de salud del micro servicio para tomar acciones apropiadas basado este reporte.                                                                                                                                                                                                                                                 |
| Racional      | Los micro servicios deberán reportar y/o publicar su estado de salud para indicar si están o no disponibles. Luego, la plataforma de orquestación, usando la información de salud indicada, puede decidir si es necesario que sea finalizado y/o reemplazado por otra instancia tendiendo a mantener un ambiente estable y operativo.              |
| Implicaciones | - Uso de frameworks o de librerias para implementar el reporte de estado de salud. <br>- Desarrollo y publicación de la prueba de vida (Liveness) y la prueba de aceptación de pedidos (Readiness) en el micro servicio.<br> - Empleo de una plataforma de orquestación que tome decisiones en función del estado de salud del micro servicio.<br> |

### Configuración elástica

|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Declaración   | Ofrecer mecanismos para poder modificar los datos de configuración sin necesidad de construir o empaquetar nuevamente la imagen del micro servicio.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Racional      | Cuando desarrollamos un micro servicio es una buena práctica externalizar los aspectos de la configuración para que podamos cambiar su comportamiento en tiempo de ejecución sin la necesidad de cambiar el código o empaquetarlo nuevamente. La información de configuración en el ambiente productivo generalmente se desconoce en el momento del desarrollo, solo en tiempo de ejecución podemos aplicar la información correcta para configurar nuestro micro servicio. Para abordar la necesidad de aplicar y modificar dinámicamente las configuraciones en una implementación de micro servicios, se necesita un mecanismo estándar capaz de permitir a los micro servicios modificar su comportamiento sin necesidad de ser desarrollados nuevamente. |
| Implicaciones | - Uso de frameworks o de librerias para implementar configuraciones externalizadas.<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |

###  Reporte de métricas o telemetrías

|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| :------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Exponer métricas o telemetrías que ayuden a administrar el micro servicio, permitiendo detectar si el mismo se vuelve inestable en tiempo de ejecución.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Racional      | Saber cómo están funcionando las instancias del micro servicio es crucial para garantizar el éxito. En producción, poder conocer la memoria del contenedor, el consumo de disco, el consumo de red, la JVM que están usando las instancias, cuántas veces se llama a un servicio, cuánto tiempo tardó en ejecutarse y varias otras métricas, ayudan al equipo de operaciones a administrar los servicios antes de que se vuelvan inestables. Con este objetivo, los micro servicios deberán proporcionar en forma estándar sus métricas centrales, las cuales incluyen: Used Heap Memory, Max Heap Memory, Garbage Collection Count, entre otras. Como así también, las métricas del vendedor o de la aplicación que se consideren importante para el dominio problema.                                                                                                                                                                                                                                      |
| Implicaciones | Uso de alguna de las siguientes estrategias:<br><br>- Empleo de un service mesh: Una malla de servicio puede recopilar datos de telemetría de toda la red de micro servicios y producir métricas consistentes en cada elemento de la red. La malla permite generar métricas del consumo de los recursos de los micro servicios. Finalmente, los micro servicios solo deben enfocarse en brindar las métricas del vendedor y/o de la aplicación que se consideren mediante el uso de librerias.<br>- Utilización de librerias o de frameworks: El micro servicio debe implementar funcionalidades para la recopilación de métricas centrales (tienen que ver con el estado de los recursos usados por el micro servicio), métricas específicas del vendedor y métricas específicas de la aplicación (tienen que ver con indicadores propios del domino del negocio) mediante el uso de librerias.<br><br>En ambos casos se necesita un sistema de monitoreo donde se puedan analizar las métricas informadas. |

###  Trazabilidad distribuida

|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| :------------ | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Ofrecer mecanismos para poder rastrear el flujo de un pedido a través del sistema distribuido con el objetivo de diagnosticar problemas o detectar anomalías.                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Racional      | Conocer el camino que sigue una petición desde su inicio hasta su final puede ayudar en la resolución de problemas. El rastreo distribuido muestra la ruta que sigue una solicitud a medida que viaja a través de un sistema distribuido. A medida que las solicitudes viajan entre los servicios, cada segmento se registra. Todos los tramos de una solicitud se combinan en un solo rastreo distribuido para dar una imagen de una solicitud completa. Una vez capturados los rastros de una petición, se puede proceder a analizarlos y resolver inconvenientes de una forma más fácil y rápida. |
| Implicaciones | Uso de alguna de las siguientes estrategias:<br><br>- Uso de un service mesh para recopilar la traza de los pedidos, mediante la propagación del contexto de traza (Trace Context Propagation).<br>- Publicación de la traza mediante el uso de librerias o bibliotecas externas.<br><br>En ambos casos se necesita un sistema de monitoreo donde se puedan analizar las trazas informadas.                                                                                                                                                                                                          |

### Registro de eventos

|               |                                                                                                                                                                                                                                                                                                                                                                                                              |
| :------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Ofrecer mecanismos para registrar o mostrar mensajes con información de lo que está sucediendo en el micro servicio.                                                                                                                                                                                                                                                                                         |
| Racional      | El registro de mensajes con información de lo que sucede dentro de un micro servicio es comúnmente conocido como log, y es de gran utilidad para los administradores/desarrolladores y en especial para el equipo de soporte. Los mensajes con información ahorran muchas horas valiosas tanto para el equipo de soporte como para los desarrolladores en el diagnostico como en la resolución de problemas. |
| Implicaciones | - Uso de librerias o de bibliotecas externas para implementar el registro de mensajes.<br>- Publicación de mensajes en la salida estándar (stdout) con diferentes niveles de severidad.<br>- Configuración de la estrategia de registro de eventos, sin necesidad de cambiar el código o construir nuevamente la imagen del micro servicio (Configuración elástica).                                         |

###  Mecanismo de comunicación

|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Emplear mecanismos de comunicación sincrónicos o asincrónicos entre los micro servicios.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Racional      | El micro servicio por sí solo no tiene sentido, es necesario que interactúe con otros para resolver un pedido o una necesidad. Cada micro servicio es capaz de recibir mensajes, procesar datos y enviar mensajes hacia otros micro servicios. Para poder establecer la comunicación, debe existir un estándar de comunicación que defina un conjunto de normas, acuerdos y recomendaciones técnicas que regulan la transmisión de mensajes entre los micro servicios. Comúnmente los mecanismos de comunicación usados entre los micro servicios son: el sincrónico (API REST) y el asincrónico (mensajería ligera AMQP). |
| Implicaciones | - Comunicación sincrónica mediante API REST: Disponer de un artefacto que permita describir su contrato, documentar sus reglas y sus especificaciones.<br>- Comunicación mediante mensajería ligera: Acordar la estructura del mensaje que es enviado del emisor al receptor y, acordar la instancia de cola de mensajes a utilizar.     
| Preferencia | Favorecer el uso de la comunicación asincrónica, ya que ayuda a mejorar el bajo acoplamiento y la extensibilidad.                                                                                                             |

###  Tolerancia a fallas

|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Declaración   | Ofrecer estrategias de tolerancia a fallas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Racional      | Es sumamente importante, para aquellos micro servicios que utilizan comunicación sincrónica, construir servicios con tolerancia a fallas. La tolerancia a fallas trata de aprovechar diferentes estrategias para guiar la ejecución y el resultado de cierta lógica. Las políticas de reintento, los Fallbacks y los CircuitBreaker son conceptos de esta área que establecen la lógica de toleracia a falla que debe llevarse a cabo y el momento en ser ejecutada, ofreciendo un resultado alternativo cuando una ejecución no se completa con éxito. |
| Implicaciones | Uso de alguna de las siguientes estrategias:<br><br>- Disponer de un service mesh para implementar diferentes estrategias para tratar las fallas, previa configuración en dicho contexto.<br>- Uso de librerias o bibliotecas para lograr diferentes políticas de tolerancia a fallas como timeout, retry, bulkhead, Circuit-Breaker, Fallback, entre otras.                                                                                                                                                                                            |

###  Altamente cohesivos

|               |                                                                                                                                                                                                                                                                                           |
| :------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Desarrollar micro servicios altamente cohesivos.                                                                                                                                                                                                                                          |
| Racional      | Los micro servicios tienen muchas responsabilidades o que son responsables de realizar muchas funciones y muy diferentes, adolecen de los problemas de dificultad para su entendimiento, dificultad en el mantenimiento y son afectados frecuentemente por los cambios que puedan surgir. |
| Implicaciones | Diseñar e implementar micro servicios con un solo propósito que no realicen gran cantidad de trabajo, aplicando el patrón de simple responsabilidad (SRP).                                                                                                                              |

### Mínimamente acoplados

|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Desarrollar micro servicios con un acoplamiento bajo.                                                                                                                                                                                                                                                                                                                                                                                                    |
| Racional      | Los micro servicios que están conectados a, tienen conocimiento de o confían en muchos otros micro servicios, adolecen de los problemas de dificultad para su entendimiento de manera aislada, son complejos de reutilizar o probar puesto que su uso requiere de la presencia adicional de otros micro servicios, de los cuales este depende. Finalmente, pueden verse altamente afectados por las modificaciones realizadas en algunos de sus vecinos. |
| Implicaciones | Diseñar e implementar micro servicios con mínimas dependencias y bajos niveles de acoplamiento aferente.
| Preferencia | Favorecer el uso de la comunicación asincrónica.                                                                                |

### Empaquetado como imagen de contenedor

|               |                                                                                                                                                                                                                                                                                                                                                         |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Declaración   | Empaquetar el micro servicio como una imagen de contenedor.                                                                                                                                                                                                                                                                                             |
| Racional      | Los contenedores son un mecanismo de implementación moderno y liviano que simplifica el desarrollo, la prueba y el despliegue de aplicaciones en múltiples entornos, requiriendo menos recursos del sistema que los entornos de máquinas virtuales tradicionales y, permitiendo que las aplicaciones se implementen, reparen o escalen más rápidamente. |
| Implicaciones | - Uso de una imagen de construcción del contenedor que describe el entorno de ejecución.<br>- Empleo del fuente de la aplicación a ser inyectada.<br>- Uso de un proceso de construcción que transforma el código fuente en una imagen de contenedor ejecutable, usando la imagen de construcción del contenedor.                                       |
| Preferencia | Uso de versionado semántico en las versiones de imagen de contenedor.                                                                                |

### Plataforma centrada en contenedores

|               |                                                                                                                                                                                                                                         |
| :------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Emplear un entorno de orquestación centrado en contenedores para ejecutar los micro servicios.                                                                                                                                          |
| Racional      | Contar con un entorno de orquestación permite gestionar los micro servicios, eliminando muchos de los procesos manuales involucrados en la implementación, instanciación, ejecución, balanceo y escalabilidad de los mismos.            |
| Implicaciones | - Uso de un entorno de orquestación centrado en contenedores.<br>- Configurar/programar el entorno de orquestación para realizar las actividades de instanciación, ejecución, balanceo y escalabilidad elástica de los micro servicios. |

### Despliegue mediante pipeline

|               |                                                                                                                                                                                                                                                                                                                                                                   |
| :------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Desplegar el micro servicio usando un pipeline de despliegue.                                                                                                                                                                                                                                                                                                     |
| Racional      | El pipeline de despliegue es una implementación automatizada de la construcción, testeo y despliegue de la aplicación, permitiendo una rapida retro-alimentación de los problemas, disponer de un mismo proceso en distintos entornos, reducir los tiempos de ejecución de las tareas y al ejecutar varias veces diariamente, aumenta la confianza en el proceso. |
| Implicaciones | - Uso de un entorno de ejecución del pipeline de despliegue.<br>- Definición de las tareas del pipeline de despliegue.<br>- Determinación del momento de ejecución del pipeline de despliegue.                                                                                                                                                                    |

###  Único repositorio

|               |                                                                                                                                                                                                                                                                                                                                                                   |
| :------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   |  Almacenar el código fuente del micro servicio en un único repositorio de código fuente.                                                                                                                                                                                                                                               |
| Racional      | Centralizar las modificaciones del micro servicio en un único repositorio permite conocer la historia de cambios, realizar trazabilidad de las evoluciones, facilitar el proceso de despliegue, gestionar y priorizar las modificaciones.  |
| Implicaciones | - Uso de un sistema de control de versiones. <br>- Vincular el código fuente del micro servicio a un solo repositorio, independiente de la cantidad de imágenes construidas o instancias ejecutadas en diferentes ambientes o dominios.                                                                                                                                                            |

### Adecuado nivel de complejidad para el dominio problema

|               |                                                                                                                                                                                                                                                                                                                                                                   |
| :------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   |  Desarrollar micro servicios con niveles de complejidad adecuados al dominio de problema que pretende atacar.                                                                              |
| Racional      | Aplicaciones construidas con códigos demasiados complejos conducen a algoritmos dificil de interpretar y de mantener, dañando varias características deseables en el codigo fuente: modularidad, capacidad de prueba, capacidad de despliegue, etc. |
| Implicaciones |  Desarrollar micro servicios con las siguientes complejidades ciclomática: 
- Domino simple : 1-4 de complejidad ciclomática. <br>
- Domino moderado: 5-10 de complejidad ciclomática. <br>
- Domino complejo: 10-15 de complejidad ciclomática. *<br> NOTA: <br> - En general el valor aceptado en la industria es 10. Mayor de 10 es un valor riesgoso.<br> - Evaluar la posibilidad de descomponer la logica del servicio.*<br>

### Identificador semántico de la imagen en el repositorio de código fuente
|               |                                                                                                                                                                                                                                                                                                                                                                   |
| :------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Declaración   | Asociar semánticamente la imagen de contenedor con su estado en el repositorio de código fuente.                                                                             |
| Racional      | Las etiquetas son apuntadores que permiten referenciar un punto en el historial del repositorio asociado a una versión determinada. Por medio del uso de etiquetas se puede obtener la imagen del repositorio al momento de crear la versión del artefacto, permitiendo acceder a su código fuente original sin ninguna otra modificación. Una foto correcta del código fuente es indispensable para poder dar soporte y dar mantenimiento a la versión de la imagen de contenedor. |
| Implicaciones | - Uso de un sistema de control de versiones. <br> - Crear un repositorio de código fuente para el micro servicio. <br>- Crear una etiqueta en el repositorio de código fuente por cada imagen de contenedor construida.
